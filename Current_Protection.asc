Version 4
SHEET 1 1804 1368
WIRE 304 -128 304 -176
WIRE 304 -128 80 -128
WIRE 528 -128 304 -128
WIRE 848 -128 528 -128
WIRE 1040 -128 848 -128
WIRE 848 -32 848 -128
WIRE 32 0 -32 0
WIRE 272 0 112 0
WIRE 544 0 432 0
WIRE 672 0 624 0
WIRE 1040 64 1040 -128
WIRE 848 96 848 48
WIRE 976 96 848 96
WIRE 528 112 528 -128
WIRE -144 128 -176 128
WIRE -32 128 -32 0
WIRE -32 128 -64 128
WIRE 80 128 80 -128
WIRE 336 128 320 128
WIRE 432 128 432 0
WIRE 432 128 416 128
WIRE 448 128 432 128
WIRE 1248 128 1168 128
WIRE -32 160 -32 128
WIRE 16 160 -32 160
WIRE 672 160 672 0
WIRE 672 160 608 160
WIRE 976 160 672 160
WIRE 272 192 272 0
WIRE 272 192 192 192
WIRE 448 192 272 192
WIRE -144 224 -176 224
WIRE -32 224 -64 224
WIRE 16 224 -32 224
WIRE 848 256 848 96
WIRE -32 288 -32 224
WIRE -32 432 -32 368
WIRE 80 432 80 256
WIRE 80 432 -32 432
WIRE 304 432 80 432
WIRE 528 432 528 208
WIRE 528 432 304 432
WIRE 848 432 848 336
WIRE 848 432 528 432
WIRE 1040 432 1040 192
WIRE 1040 432 848 432
WIRE 304 480 304 432
FLAG 320 128 0
FLAG -176 224 VINP
IOPIN -176 224 In
FLAG -176 128 VINN
IOPIN -176 128 In
FLAG 304 -176 VDDA
IOPIN 304 -176 In
FLAG 304 480 GNDA
IOPIN 304 480 Out
FLAG 1248 128 VOUT
IOPIN 1248 128 Out
SYMBOL Error_Amplifier 96 208 R0
SYMATTR InstName X1
SYMBOL res -48 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 200k
SYMBOL res 128 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 1Meg
SYMBOL res -48 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 200k
SYMBOL res -48 272 R0
SYMATTR InstName R4
SYMATTR Value 1Meg
SYMBOL res 432 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL res 640 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 1Meg
SYMBOL Pmos_Error_Amplifier 528 176 R0
SYMATTR InstName X2
SYMBOL Comparator 1040 112 R0
SYMATTR InstName X3
SYMBOL res 832 -48 R0
SYMATTR InstName R8
SYMATTR Value 400k
SYMBOL res 832 240 R0
SYMATTR InstName R9
SYMATTR Value 1.4Meg
TEXT 128 272 Left 2 ;NMOS INPUT STAGE
TEXT 576 272 Left 2 ;PMOS INPUT STAGE
TEXT 176 352 Left 2 ;Gain is around 43.2 V/V
TEXT 416 -176 Left 2 !.include tsmc018.lib
TEXT 560 592 Center 2 ;Problem with single stage comparator (NMOS input stage) is that it gives logic high better but logic low as something as voltage follower.\nSo it should be used only when logic high is required\nHere I have to ensure that is no false positive overcurrent detection, So used a specialised comparator
