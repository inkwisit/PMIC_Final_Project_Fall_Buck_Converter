Version 4
SHEET 1 1252 852
WIRE 128 -288 128 -352
WIRE 144 -288 128 -288
WIRE -496 -272 -736 -272
WIRE -432 -272 -496 -272
WIRE 128 -272 128 -288
WIRE -432 -256 -464 -256
WIRE -192 -256 -368 -256
WIRE -80 -256 -192 -256
WIRE 80 -256 -16 -256
WIRE 144 -224 144 -288
WIRE 144 -224 128 -224
WIRE -464 -176 -464 -256
WIRE -368 -176 -464 -176
WIRE -160 -176 -304 -176
WIRE -496 -112 -496 -272
WIRE 128 -96 128 -176
WIRE 320 -96 128 -96
WIRE 512 -96 400 -96
WIRE 592 -96 512 -96
WIRE 672 -96 592 -96
WIRE 752 -96 672 -96
WIRE 864 -96 752 -96
WIRE 1168 -96 864 -96
WIRE -368 -48 -464 -48
WIRE -192 -48 -192 -256
WIRE -192 -48 -304 -48
WIRE 512 -48 512 -96
WIRE 592 -48 592 -96
WIRE 672 -48 672 -96
WIRE 752 -48 752 -96
WIRE 864 -48 864 -96
WIRE 128 -16 128 -96
WIRE 144 32 128 32
WIRE -160 64 -160 -176
WIRE -160 64 -368 64
WIRE -80 64 -160 64
WIRE 80 64 -16 64
WIRE -464 80 -464 -48
WIRE -432 80 -464 80
WIRE -496 96 -496 -48
WIRE -432 96 -496 96
WIRE 128 96 128 80
WIRE 144 96 144 32
WIRE 144 96 128 96
WIRE 512 96 512 16
WIRE 592 96 592 16
WIRE 672 96 672 16
WIRE 752 96 752 16
WIRE 864 96 864 32
WIRE -1072 112 -1072 16
WIRE 128 144 128 96
WIRE 1168 272 1168 -96
WIRE -1072 288 -1072 192
WIRE 320 304 176 304
WIRE 512 304 384 304
WIRE -576 496 -576 400
WIRE -176 496 -240 496
WIRE -400 528 -512 528
WIRE -176 528 -240 528
WIRE 368 528 368 432
WIRE -736 560 -736 -272
WIRE -704 560 -736 560
WIRE -176 560 -240 560
WIRE 512 560 512 304
WIRE 512 560 432 560
WIRE 1168 560 1168 352
WIRE 1168 560 512 560
WIRE 176 592 176 304
WIRE 176 592 -512 592
WIRE 256 592 176 592
WIRE 656 592 656 496
WIRE 512 624 432 624
WIRE 576 624 512 624
WIRE 1168 640 1168 560
WIRE 1168 800 1168 720
WIRE -576 832 -576 624
WIRE 368 832 368 656
WIRE 656 832 656 656
FLAG 128 144 0
FLAG 752 96 0
FLAG 864 96 0
FLAG 1168 800 0
FLAG 672 96 0
FLAG 592 96 0
FLAG 512 96 0
FLAG -1072 16 vdd
FLAG -1072 288 0
FLAG 128 -352 vdd
FLAG -576 832 0
FLAG -576 400 vdd
FLAG 368 432 vdd
FLAG 368 832 0
FLAG -176 528 vdd
FLAG -176 496 0
FLAG 656 832 0
FLAG 512 624 vref
FLAG -176 560 vref
FLAG 656 496 vdd
SYMBOL voltage -1072 96 R0
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PULSE(0 1.8 0 1n)
SYMBOL ind 304 -80 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 0.47µ
SYMATTR SpiceLine Rser=32m
SYMBOL cap 736 -48 R0
SYMATTR InstName C1
SYMATTR Value 10µ
SYMATTR SpiceLine Rser=10m Lser=1n
SYMBOL cmosp 80 -176 M180
SYMATTR InstName M1
SYMATTR Value2 l=180n w=100u m=500
SYMBOL cmosn 80 -16 R0
SYMATTR InstName M2
SYMATTR Value2 l=180n w=100u m=200
SYMBOL load2 864 -48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value PULSE(0 100m 1n)
SYMBOL Digital\\and -400 -336 R0
WINDOW 3 -61 61 Left 2
SYMATTR Value Vhigh=1.8,Vlow=0
SYMATTR InstName A1
SYMBOL Digital\\and -400 16 R0
WINDOW 3 -48 62 Left 2
SYMATTR Value Vhigh=1.8,Vlow=0
SYMATTR InstName A2
SYMBOL Digital\\inv -432 -112 R90
WINDOW 3 -78 60 Left 2
SYMATTR Value Vhigh=1.8,Vlow=0
SYMATTR InstName A3
SYMBOL Digital\\inv -304 -112 R180
WINDOW 3 -106 66 Left 2
SYMATTR Value Vhigh=1.8,Vlow=0,Td=10n
SYMATTR InstName A4
SYMBOL Digital\\buf1 -304 16 R180
WINDOW 3 -107 61 Left 2
SYMATTR Value Vhigh=1.8,Vlow=0,Td=10n
SYMATTR InstName A5
SYMBOL Digital\\buf1 -80 -320 R0
WINDOW 3 -217 63 Left 2
SYMATTR Value Vhigh=1.8, Vlow=0, Trise = {trf}, Tfall = {trf}
SYMATTR InstName A6
SYMBOL Digital\\buf1 -80 0 R0
WINDOW 3 -218 61 Left 2
SYMATTR Value Vhigh=1.8, Vlow=0, Trise = {trf}, Tfall = {trf}
SYMATTR InstName A7
SYMBOL res 1152 256 R0
SYMATTR InstName R1
SYMATTR Value 50k
SYMBOL res 1152 624 R0
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL cap 656 -48 R0
SYMATTR InstName C2
SYMATTR Value 10µ
SYMATTR SpiceLine Rser=10m Lser=1n
SYMBOL cap 576 -48 R0
SYMATTR InstName C3
SYMATTR Value 10µ
SYMATTR SpiceLine Rser=10m Lser=1n
SYMBOL cap 496 -48 R0
SYMATTR InstName C4
SYMATTR Value 10µ
SYMATTR SpiceLine Rser=10m Lser=1n
SYMBOL Comparator -576 544 M0
SYMATTR InstName X1
SYMBOL Error_Amplifier 352 608 M0
SYMATTR InstName X2
SYMBOL Oscillator -320 528 M0
SYMATTR InstName X3
SYMBOL Bandgap_Reference 672 624 M0
SYMATTR InstName X4
SYMBOL cap 384 288 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C5
SYMATTR Value 200p
TEXT 608 -264 Left 2 !.tran 200u
TEXT 608 -288 Left 2 !.include tsmc018.lib
TEXT 608 -312 Left 2 !.param td 1n
TEXT 608 -336 Left 2 !.param trf 1n
TEXT 168 -144 Left 2 ;Putting 1nH ESL in capacitor makes the loop unstable.
TEXT 616 -240 Left 2 !.include opamp.sub
TEXT -472 424 Left 2 ;Ramp Generator cum Oscillator
TEXT 176 656 Left 2 ;Error Amplifier
TEXT -720 632 Left 2 ;Comparator
TEXT 696 680 Left 2 ;Bandgap Reference @ 0.8V
