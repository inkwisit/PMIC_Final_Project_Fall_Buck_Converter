Version 4
SHEET 1 2164 996
WIRE 416 -432 416 -512
WIRE 128 -416 128 -480
WIRE 336 -416 128 -416
WIRE 128 -400 128 -416
WIRE 544 -368 496 -368
WIRE 560 -368 544 -368
WIRE 336 -320 128 -320
WIRE 128 -288 128 -320
WIRE 144 -288 128 -288
WIRE -496 -272 -736 -272
WIRE -432 -272 -496 -272
WIRE 128 -272 128 -288
WIRE -432 -256 -464 -256
WIRE -192 -256 -368 -256
WIRE -80 -256 -192 -256
WIRE 80 -256 -16 -256
WIRE 416 -256 416 -304
WIRE 144 -224 144 -288
WIRE 144 -224 128 -224
WIRE -464 -176 -464 -256
WIRE -368 -176 -464 -176
WIRE -160 -176 -304 -176
WIRE -496 -112 -496 -272
WIRE 128 -96 128 -176
WIRE 176 -96 128 -96
WIRE 320 -96 176 -96
WIRE 464 -96 400 -96
WIRE 544 -96 464 -96
WIRE 624 -96 544 -96
WIRE 704 -96 624 -96
WIRE 784 -96 704 -96
WIRE 928 -96 784 -96
WIRE 1328 -96 928 -96
WIRE 1360 -96 1328 -96
WIRE -368 -48 -464 -48
WIRE -192 -48 -192 -256
WIRE -192 -48 -304 -48
WIRE 464 -48 464 -96
WIRE 544 -48 544 -96
WIRE 624 -48 624 -96
WIRE 704 -48 704 -96
WIRE 784 -48 784 -96
WIRE 928 -48 928 -96
WIRE 128 -16 128 -96
WIRE 144 32 128 32
WIRE -160 64 -160 -176
WIRE -160 64 -368 64
WIRE -80 64 -160 64
WIRE 80 64 -16 64
WIRE -464 80 -464 -48
WIRE -432 80 -464 80
WIRE -496 96 -496 -48
WIRE -432 96 -496 96
WIRE 128 96 128 80
WIRE 144 96 144 32
WIRE 144 96 128 96
WIRE 464 96 464 16
WIRE 544 96 544 16
WIRE 624 96 624 16
WIRE 704 96 704 16
WIRE 784 96 784 16
WIRE 928 96 928 32
WIRE -1072 112 -1072 16
WIRE 128 144 128 96
WIRE -736 192 -736 -272
WIRE 1360 208 1360 -96
WIRE 1360 208 1264 208
WIRE 1264 272 1264 208
WIRE 1360 272 1360 208
WIRE -1072 288 -1072 192
WIRE 320 304 272 304
WIRE 480 304 400 304
WIRE 608 304 544 304
WIRE 1264 400 1264 336
WIRE 1360 400 1360 352
WIRE 1360 400 1264 400
WIRE -576 496 -576 400
WIRE -176 496 -240 496
WIRE -464 528 -512 528
WIRE -400 528 -464 528
WIRE -176 528 -240 528
WIRE 464 528 464 432
WIRE 32 544 32 496
WIRE 128 544 128 496
WIRE -736 560 -736 192
WIRE -704 560 -736 560
WIRE -400 560 -448 560
WIRE -176 560 -240 560
WIRE 608 560 608 304
WIRE 608 560 528 560
WIRE 992 560 608 560
WIRE 1360 560 1360 400
WIRE 1360 560 992 560
WIRE 1600 560 1360 560
WIRE 1872 560 1600 560
WIRE -64 592 -512 592
WIRE -16 592 -64 592
WIRE 272 592 272 304
WIRE 272 592 176 592
WIRE 304 592 272 592
WIRE 352 592 304 592
WIRE 752 592 752 496
WIRE 608 624 528 624
WIRE 672 624 608 624
WIRE 1360 640 1360 560
WIRE 1600 640 1600 560
WIRE 1872 640 1872 560
WIRE 1360 784 1360 720
WIRE 1600 784 1600 720
WIRE 1872 784 1872 720
WIRE 1376 832 1360 832
WIRE 1616 832 1600 832
WIRE 1888 832 1872 832
WIRE 1312 864 1232 864
WIRE 1552 864 1472 864
WIRE 1824 864 1744 864
WIRE 1360 896 1360 880
WIRE 1376 896 1376 832
WIRE 1376 896 1360 896
WIRE 1600 896 1600 880
WIRE 1616 896 1616 832
WIRE 1616 896 1600 896
WIRE 1872 896 1872 880
WIRE 1888 896 1888 832
WIRE 1888 896 1872 896
WIRE -576 976 -576 624
WIRE 80 976 80 640
WIRE 464 976 464 656
WIRE 752 976 752 656
WIRE 1360 976 1360 896
WIRE 1600 976 1600 896
WIRE 1872 976 1872 896
FLAG 128 144 0
FLAG 928 96 0
FLAG 544 96 0
FLAG 464 96 0
FLAG -1072 16 vdd
FLAG -1072 288 0
FLAG 128 -480 vdd
FLAG -576 976 0
FLAG -576 400 vdd
FLAG 464 432 vdd
FLAG 464 976 0
FLAG -176 528 vdd
FLAG -176 496 0
FLAG 752 976 0
FLAG 608 624 vref
FLAG -176 560 vref
FLAG 752 496 vdd
FLAG 1360 976 0
FLAG 1600 976 0
FLAG 1232 864 vdd
FLAG 1472 864 0
FLAG 624 96 0
FLAG 704 96 0
FLAG 784 96 0
FLAG 128 496 vdd
FLAG 992 560 vfb
FLAG -464 528 vramp
FLAG -736 192 vpwm
FLAG 1872 976 0
FLAG 1744 864 0
FLAG 80 976 0
FLAG 32 496 V1uA
FLAG -448 560 V1uA
FLAG 304 592 ver
FLAG -64 592 vss
FLAG 1328 -96 out
FLAG 176 -96 vsw
FLAG 416 -256 0
FLAG 544 -368 vsc
FLAG 416 -512 vdd
SYMBOL voltage -1072 96 R0
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PULSE(0 1.8 0 1n)
SYMBOL ind 304 -80 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 0.47µ
SYMATTR SpiceLine Rser=32m
SYMBOL cmosp 80 -176 M180
SYMATTR InstName M1
SYMATTR Value2 l=180n w=100u m=500
SYMBOL cmosn 80 -16 R0
SYMATTR InstName M2
SYMATTR Value2 l=180n w=100u m=200
SYMBOL Digital\\and -400 -336 R0
WINDOW 3 -61 61 Left 2
SYMATTR Value Vhigh=1.8,Vlow=0
SYMATTR InstName A1
SYMBOL Digital\\and -400 16 R0
WINDOW 3 -48 62 Left 2
SYMATTR Value Vhigh=1.8,Vlow=0
SYMATTR InstName A2
SYMBOL Digital\\inv -432 -112 R90
WINDOW 3 -78 60 Left 2
SYMATTR Value Vhigh=1.8,Vlow=0
SYMATTR InstName A3
SYMBOL Digital\\inv -304 -112 R180
WINDOW 3 -106 66 Left 2
SYMATTR Value Vhigh=1.8,Vlow=0,Td=10n
SYMATTR InstName A4
SYMBOL Digital\\buf1 -304 16 R180
WINDOW 3 -107 61 Left 2
SYMATTR Value Vhigh=1.8,Vlow=0,Td=10n
SYMATTR InstName A5
SYMBOL Digital\\buf1 -80 -320 R0
WINDOW 3 -217 63 Left 2
SYMATTR Value Vhigh=1.8, Vlow=0, Trise = {trf}, Tfall = {trf}
SYMATTR InstName A6
SYMBOL Digital\\buf1 -80 0 R0
WINDOW 3 -218 61 Left 2
SYMATTR Value Vhigh=1.8, Vlow=0, Trise = {trf}, Tfall = {trf}
SYMATTR InstName A7
SYMBOL res 1344 256 R0
SYMATTR InstName R1
SYMATTR Value 100k
SYMBOL cap 528 -48 R0
SYMATTR InstName C3
SYMATTR Value 2.2µ
SYMATTR SpiceLine Rser=10m Lser=1n
SYMBOL cap 448 -48 R0
SYMATTR InstName C4
SYMATTR Value 2.2µ
SYMATTR SpiceLine Rser=10m Lser=1n
SYMBOL Comparator -576 544 M0
SYMATTR InstName X1
SYMBOL Error_Amplifier 448 608 M0
SYMATTR InstName X2
SYMBOL Oscillator -320 528 M0
SYMATTR InstName X3
SYMBOL Bandgap_Reference 768 624 M0
SYMATTR InstName X4
SYMBOL cap 1248 272 R0
SYMATTR InstName C6
SYMATTR Value 30.65p
SYMBOL res 416 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 500k
SYMBOL cap 544 288 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C5
SYMATTR Value 12.65p
SYMBOL cmosn 1312 784 R0
SYMATTR InstName M3
SYMATTR Value2 l=180n w=1u
SYMBOL cmosn 1552 784 R0
SYMATTR InstName M4
SYMATTR Value2 l=180n w=1u
SYMBOL res 1344 624 R0
SYMATTR InstName R2
SYMATTR Value 50k
SYMBOL res 1584 624 R0
SYMATTR InstName R4
SYMATTR Value 166.66k
SYMBOL cap 608 -48 R0
SYMATTR InstName C1
SYMATTR Value 2.2µ
SYMATTR SpiceLine Rser=10m Lser=1n
SYMBOL cap 688 -48 R0
SYMATTR InstName C2
SYMATTR Value 2.2µ
SYMATTR SpiceLine Rser=10m Lser=1n
SYMBOL cap 768 -48 R0
SYMATTR InstName C7
SYMATTR Value 2.2µ
SYMATTR SpiceLine Rser=10m Lser=1n
SYMBOL Soft_Start 64 592 R0
SYMATTR InstName X5
SYMBOL cmosn 1824 784 R0
SYMATTR InstName M5
SYMATTR Value2 l=180n w=1u
SYMBOL res 1856 624 R0
SYMATTR InstName R5
SYMATTR Value 71.43k
SYMBOL res 112 -416 R0
SYMATTR InstName R6
SYMATTR Value 10m
SYMBOL Inrush_Current_Protection_Circuit 416 -368 R0
WINDOW 0 61 -71 Bottom 2
SYMATTR InstName X6
SYMBOL res 912 -64 R0
SYMATTR InstName R7
SYMATTR Value 1.5
TEXT 608 -264 Left 2 !.tran 0 2m 0 1n
TEXT 608 -288 Left 2 !.include tsmc018.lib
TEXT 608 -312 Left 2 !.param td 1n
TEXT 608 -336 Left 2 !.param trf 1n
TEXT 168 -144 Left 2 ;Putting 1nH ESL in capacitor makes the loop unstable.
TEXT -472 424 Left 2 ;Ramp Generator cum Oscillator
TEXT 272 656 Left 2 ;Error Amplifier
TEXT -720 632 Left 2 ;Comparator
TEXT 936 632 Left 2 ;Bandgap Reference @ 0.5V
TEXT 1296 904 Left 2 ;1.5V
TEXT 1528 904 Left 2 ;0.8V
TEXT 1800 904 Left 2 ;1.2V
TEXT -128 680 Left 2 ;Soft Start Circuit
TEXT 1408 504 Left 2 ;At 1.5V and 1A output current it automatically gets into PSM mode.
