* C:\Users\subha\OneDrive\Documents\GitHub\PMIC_Final_Project_Fall_Buck_Converter\tb_oscillator.asc
XX1 0 N001 N002 vout oscillator
V1 N001 0 PULSE(0 1.8 0 1n)
V2 N002 0 PULSE(0 0.5 1n 1u)

* block symbol definitions
.subckt oscillator GNDA VDDA vref VOUT
M1 N002 N001 vdda vdda CMOSP l=360n w=2.5u
M2 N001 N001 vdda vdda CMOSP l=360n w=2.5u
M3 N002 vref N005 N005 CMOSN l=360n w=500n
M4 N001 0v5 N005 N005 CMOSN l=360n w=500n
M5 N005 vbn0 GNDA GNDA CMOSN l=720n w=2u
M6 vbn0 vbn0 GNDA GNDA CMOSP l=720n w=2u
M7 vbn0 vbp0 vdda vdda CMOSP l=360n w=2.5u
Q1 N006 N007 GNDA 0 2N3904
R1 N007 GNDA 1Meg
Q2 vbp0 N006 N007 0 2N3904
M8 vbp0 vbp0 vdda vdda CMOSP l=360n w=2.5u
R2 vdda N006 1Meg
M9 1v3 N002 vdda vdda CMOSP l=180n w=1u
M10 VOUT N002 vdda vdda CMOSP l=180n w=2u
C1 VOUT GNDA 0.25p
R3 1v3 0v5 900k
R4 0v5 GNDA 500k
M11 VOUT Q GNDA GNDA CMOSN l=180n w=1u
M12 Q_b S GNDA GNDA CMOSN l=180n w=270n
M13 Q_b Q GNDA GNDA CMOSN l=180n w=270n
M14 N003 S vdda vdda CMOSP l=180n w=540n
M15 Q_b Q N003 N003 CMOSP l=180n w=540n
M16 Q R GNDA GNDA CMOSN l=180n w=270n
M17 Q Q_b GNDA GNDA CMOSN l=180n w=270n
M18 N004 R vdda vdda CMOSP l=180n w=540n
M19 Q Q_b N004 N004 CMOSP l=180n w=540n
C2 vdda N002 1p
XX1 vdda 1v3 VOUT gnda S comparator
XX2 vdda VOUT 0v5 gnda R comparator
.include tsmc018.lib
.ends oscillator

.subckt comparator VDDA VINN VINP GNDA VOUT
M1 outp1 N002 VDDA VDDA CMOSP l=180n w=1.35u
M2 outn1 N002 VDDA VDDA CMOSP l=180n w=1.35u
M3 outp1 vinp N007 N007 CMOSN l=180n w=270n
M4 outn1 vinn N007 N007 CMOSN l=180n w=270n
M5 N007 N011 GNDA GNDA CMOSN l=720n w=2u
R1 N002 outn1 100k
R2 outp1 N002 100k
M6 pmos_gate N003 VDDA VDDA CMOSP l=180n w=1.35u
M7 N003 N003 VDDA VDDA CMOSP l=180n w=1.35u
M8 pmos_gate outn1 N008 N008 CMOSN l=180n w=270n
M9 N003 outp1 N008 N008 CMOSN l=180n w=270n
M10 N008 N011 GNDA GNDA CMOSN l=720n w=2u
M11 VOUT pmos_gate VDDA VDDA CMOSP l=180n w=700n
M12 VOUT nmos_gate GNDA GNDA CMOSN l=180n w=270n
M18 N011 N011 GNDA GNDA CMOSP l=720n w=2u
M19 N011 N001 VDDA VDDA CMOSP l=720n w=10u
Q1 N010 N012 GNDA 0 2N3904
R3 N012 GNDA 1Meg
Q2 N001 N010 N012 0 2N3904
M20 N001 N001 VDDA VDDA CMOSP l=360n w=2.5u
R4 VDDA N010 1Meg
M21 N004 N001 VDDA VDDA CMOSP l=720n w=10u
M22 outn2 vinn N004 N004 CMOSP l=180n w=1.35u
M23 outp2 vinp N004 N004 CMOSP l=180n w=1.35u
M24 outn2 N006 GNDA GNDA CMOSN l=180n w=270n
M25 outp2 N006 GNDA GNDA CMOSN l=180n w=270n
R5 N006 outp2 100k
R6 outn2 N006 100k
M13 N005 N001 VDDA VDDA CMOSP l=720n w=10u
M14 nmos_gate outn2 N005 N005 CMOSP l=180n w=1.35u
M15 N009 outp2 N005 N005 CMOSP l=180n w=1.35u
M16 nmos_gate N009 GNDA GNDA CMOSN l=180n w=270n
M17 N009 N009 GNDA GNDA CMOSN l=180n w=270n
.include tsmc018.lib
.ends comparator

.model NPN NPN
.model PNP PNP
.lib C:\Users\subha\OneDrive\Documents\LTspiceXVII\lib\cmp\standard.bjt
.model NMOS NMOS
.model PMOS PMOS
.lib C:\Users\subha\OneDrive\Documents\LTspiceXVII\lib\cmp\standard.mos
.tran 0 20u 0 0.1n
.backanno
.end
