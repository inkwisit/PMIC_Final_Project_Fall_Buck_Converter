* C:\Users\subha\OneDrive\Documents\GitHub\PMIC_Final_Project_Fall_Buck_Converter\Buck_Regulator_Schematic.asc
V1 vdd 0 PULSE(0 1.8 0 1n)
L1 vsw out 0.47µ Rser=32m
M1 vsw N004 N001 N001 CMOSP l=180n w=100u m=500
M2 vsw N007 0 0 CMOSN l=180n w=100u m=200
A1 0 0 vpwm N002 0 N003 0 0 AND Vhigh=1.8,Vlow=0
A2 0 0 N006 N008 0 0 N005 0 AND Vhigh=1.8,Vlow=0
A3 vpwm 0 0 0 0 N008 0 0 BUF Vhigh=1.8,Vlow=0
A4 N005 0 0 0 0 N002 0 0 BUF Vhigh=1.8,Vlow=0,Td=10n
A5 N003 0 0 0 0 0 N006 0 BUF Vhigh=1.8,Vlow=0,Td=10n
A6 N003 0 0 0 0 0 N004 0 BUF Vhigh=1.8, Vlow=0, Trise = {trf}, Tfall = {trf}
A7 N005 0 0 0 0 0 N007 0 BUF Vhigh=1.8, Vlow=0, Trise = {trf}, Tfall = {trf}
R1 out vfb 100k
C3 out 0 2.2µ Rser=10m Lser=1n
C4 out 0 2.2µ Rser=10m Lser=1n
XX1 vdd vramp vss 0 vpwm comparator
XX2 vdd vfb vref 0 ver error_amplifier
XX3 0 vdd vref vramp V1uA oscillator
XX4 vdd 0 vref bandgap_reference
C6 out vfb 30.65p
R3 N009 ver 500k
C5 vfb N009 12.65p
M3 N010 0 0 0 CMOSN l=180n w=1u
M4 N011 vdd 0 0 CMOSN l=180n w=1u
R2 vfb N010 50k
R4 vfb N011 166.66k
C1 out 0 2.2µ Rser=10m Lser=1n
C2 out 0 2.2µ Rser=10m Lser=1n
C7 out 0 2.2µ Rser=10m Lser=1n
XX5 V1uA vdd 0 ver vss soft_start
M5 N012 0 0 0 CMOSN l=180n w=1u
R5 vfb N012 71.43k
R6 vdd N001 10m
XX6 vdd N001 vdd 0 vsc inrush_current_protection_circuit
R7 out 0 1.5

* block symbol definitions
.subckt comparator VDDA VINN VINP GNDA VOUT
M1 outp1 N002 VDDA VDDA CMOSP l=180n w=1.35u
M2 outn1 N002 VDDA VDDA CMOSP l=180n w=1.35u
M3 outp1 vinp N007 N007 CMOSN l=180n w=270n
M4 outn1 vinn N007 N007 CMOSN l=180n w=270n
M5 N007 N010 GNDA GNDA CMOSN l=720n w=2u
R1 N002 outn1 100k
R2 outp1 N002 100k
M6 pmos_gate N003 VDDA VDDA CMOSP l=180n w=1.35u
M7 N003 N003 VDDA VDDA CMOSP l=180n w=1.35u
M8 pmos_gate outn1 N008 N008 CMOSN l=180n w=270n
M9 N003 outp1 N008 N008 CMOSN l=180n w=270n
M10 N008 N010 GNDA GNDA CMOSN l=720n w=2u
M11 VOUT pmos_gate VDDA VDDA CMOSP l=180n w=700n
M12 VOUT nmos_gate GNDA GNDA CMOSN l=180n w=270n
M19 N010 N001 VDDA VDDA CMOSP l=720n w=10u
M20 N001 N001 VDDA VDDA CMOSP l=360n w=2.5u
M21 N004 N001 VDDA VDDA CMOSP l=720n w=10u
M22 outn2 vinn N004 N004 CMOSP l=180n w=1.35u
M23 outp2 vinp N004 N004 CMOSP l=180n w=1.35u
M24 outn2 N006 GNDA GNDA CMOSN l=180n w=270n
M25 outp2 N006 GNDA GNDA CMOSN l=180n w=270n
R5 N006 outp2 100k
R6 outn2 N006 100k
M13 N005 N001 VDDA VDDA CMOSP l=720n w=10u
M14 nmos_gate outn2 N005 N005 CMOSP l=180n w=1.35u
M15 N009 outp2 N005 N005 CMOSP l=180n w=1.35u
M16 nmos_gate N009 GNDA GNDA CMOSN l=180n w=270n
M17 N009 N009 GNDA GNDA CMOSN l=180n w=270n
M18 N010 N010 GNDA GNDA CMOSN l=720n w=2u
R3 N001 GNDA 1Meg
.include tsmc018.lib
.ends comparator

.subckt error_amplifier VDDA VINN VINP GNDA VOUT
M12 N004 N004 GNDA GNDA CMOSN l=180n w=1u
M2 N005 N004 GNDA GNDA CMOSN l=180n w=3u
M3 N001 N001 VDDA VDDA CMOSP l=180n w=2u
M4 N002 N001 VDDA VDDA CMOSP l=180n w=2u
M5 N001 VINN N005 GNDA CMOSN l=180n w=1u
M6 N002 VINP N005 GNDA CMOSN l=180n w=1u
M7 VOUT N002 VDDA VDDA CMOSP l=180n w=10u
M8 VOUT N004 GNDA GNDA CMOSN l=180n w=3u
C1 VOUT N003 8f
R3 N003 N002 18.5k
R1 VDDA N004 400k
.include tsmc018.lib
.ends error_amplifier

.subckt oscillator GNDA VDDA vref VOUT V1uA
M1 N004 N003 vdda vdda CMOSP l=360n w=2.5u
M2 N003 N003 vdda vdda CMOSP l=360n w=2.5u
M3 N004 N011 N007 N007 CMOSN l=360n w=500n
M4 N003 1v2 N007 N007 CMOSN l=360n w=500n
M5 N007 vbn0 GNDA GNDA CMOSN l=720n w=2u
M9 1v2 N004 vdda vdda CMOSP l=180n w=1u
M10 VOUT V1uA vdda vdda CMOSP l=180n w=1.1u
C1 VOUT GNDA 0.125p
M11 VOUT N012 GNDA GNDA CMOSN l=180n w=2.2u
M12 Q_b S GNDA GNDA CMOSN l=180n w=270n
M13 Q_b Q GNDA GNDA CMOSN l=180n w=270n
M14 N005 S vdda vdda CMOSP l=180n w=1u
M15 Q_b Q N005 N005 CMOSP l=180n w=1u
M16 Q R GNDA GNDA CMOSN l=180n w=270n
M17 Q Q_b GNDA GNDA CMOSN l=180n w=270n
M18 N006 R vdda vdda CMOSP l=180n w=270n
M19 Q Q_b N006 N006 CMOSP l=180n w=270n
M20 S N001 vdda vdda CMOSP l=180n w=5u
M21 N001 N001 vdda vdda CMOSP l=180n w=5u
M22 S 1v2 N009 N009 CMOSN l=180n w=1u
M23 N001 VOUT N009 N009 CMOSN l=180n w=1u
M24 N009 vbn0 GNDA GNDA CMOSN l=720n w=2u
M25 R N002 vdda vdda CMOSP l=180n w=1u
M26 N002 N002 vdda vdda CMOSP l=180n w=1u
M27 R VOUT N010 N010 CMOSN l=180n w=270n
M28 N002 vref N010 N010 CMOSN l=180n w=270n
M29 N010 vbn0 GNDA GNDA CMOSN l=720n w=2u
M30 N008 V1uA vdda vdda CMOSP l=180n w=11u
R5 N008 N012 100k
M31 N008 N008 GNDA GNDA CMOSN l=180n w=1u
M32 N012 Q_b GNDA GNDA CMOSN l=180n w=270n
R6 V1uA N004 100k
M33 vbn0 vbn0 GNDA GNDA CMOSN l=720n w=2u
R4 1v2 GNDA 1.2Meg
R1 vdda vbn0 2Meg
R2 vdda N011 600k
R3 N011 GNDA 1.2Meg
.include tsmc018.lib
.ends oscillator

.subckt bandgap_reference VDDA GNDA Vref
M1 N006 N001 VDDA VDDA CMOSP l=360n w=2.5u
M2 N004 N001 VDDA VDDA CMOSP l=360n w=2.5u
M3 Vref N002 VDDA VDDA CMOSP l=360n w=2.5u
R1 Vref GNDA 38.196k
R2 N006 N007 10k
R3 N006 GNDA 93.865k
Q1 GNDA GNDA N004 0 PNP_V50X50_MM
R4 N004 GNDA 93.865k
M4 N001 N003 VDDA VDDA CMOSP l=360n w=2.5u
M5 N003 N003 VDDA VDDA CMOSP l=360n w=2.5u
Q2 GNDA GNDA N007 0 PNP_V50X50_MM
Q3 GNDA GNDA N007 0 PNP_V50X50_MM
Q4 GNDA GNDA N007 0 PNP_V50X50_MM
Q5 GNDA GNDA N007 0 PNP_V50X50_MM
Q6 GNDA GNDA N007 0 PNP_V50X50_MM
Q7 GNDA GNDA N007 0 PNP_V50X50_MM
Q8 GNDA GNDA N007 0 PNP_V50X50_MM
Q9 GNDA GNDA N007 0 PNP_V50X50_MM
M6 N001 N004 N005 N005 CMOSN l=360n w=500n
M7 N003 N006 N005 N005 CMOSN l=360n w=500n
M8 N005 vbn0 GNDA GNDA CMOSN l=720n w=2u
M9 vbn0 vbn0 GNDA GNDA CMOSP l=720n w=2u
C1 VDDA N004 1p
R7 N002 N001 100k
R5 VDDA vbn0 1Meg
.include tsmc018.lib
.include mm180_bjt_v121.mdl
.ends bandgap_reference

.subckt soft_start V1uA VDDA GNDA VER VSS_ER
M1 vramp V1uA VDDA VDDA CMOSP l=180n w=1.1u
C1 vramp GNDA 555p
M2 N001 N001 VDDA VDDA CMOSP l=180n w=1u
M3 Vselect N001 VDDA VDDA CMOSP l=180n w=1u
M4 N001 vramp N002 N002 CMOSN l=180n w=270n
M5 Vselect ver N002 N002 CMOSN l=180n w=270n
M6 N002 N003 GNDA GNDA CMOSN l=180n w=1u
M7 N003 V1uA VDDA VDDA CMOSP l=180n w=1.1u
M8 N003 N003 GNDA GNDA CMOSN l=180n w=1u
XX1 VER vramp Vselect VDDA GNDA VSS_ER analog_mux
.ends soft_start

.subckt inrush_current_protection_circuit VDDA VINN VINP GNDA VOUT
M1 N009 N009 GNDA GNDA CMOSN l=180n w=1u
M2 N010 N009 GNDA GNDA CMOSN l=180n w=3u
M3 N001 N001 VDDA VDDA CMOSP l=180n w=2u
M4 N003 N001 VDDA VDDA CMOSP l=180n w=2u
M5 N001 VINN N010 GNDA CMOSN l=180n w=1u
M6 N003 VINP N010 GNDA CMOSN l=180n w=1u
M7 N004 N003 VDDA VDDA CMOSP l=180n w=10u
M8 N004 N009 GNDA GNDA CMOSN l=180n w=3u
R2 VDDA N009 400k
M9 VOUT N002 VDDA VDDA CMOSP l=180n w=1u
M10 N002 N002 VDDA VDDA CMOSP l=180n w=1u
M11 VOUT N008 N006 N006 CMOSN l=180n w=270n
M12 N002 N007 N006 N006 CMOSN l=180n w=270n
M13 N006 NC_01 GNDA GNDA CMOSN l=720n w=2u
R5 VDDA N008 1.3Meg
R6 N008 GNDA 500k
M14 N005 N004 VDDA VDDA CMOSP l=180n w=10u
M15 N005 N009 GNDA GNDA CMOSN l=180n w=3u
M16 N007 N005 VDDA VDDA CMOSP l=180n w=10u
M17 N007 N009 GNDA GNDA CMOSN l=180n w=3u
R1 N007 N003 10k
.include tsmc018.lib
.ends inrush_current_protection_circuit

.subckt analog_mux IN_A IN_B Sel VDDA GNDA OUT
M1 N002 Sel GNDA GNDA CMOSN l=180n w=270n
M2 N002 Sel VDDA VDDA CMOSP l=180n w=1u
M3 OUT N002 IN_A VDDA CMOSP l=180n w=1u
M4 OUT Sel IN_A GNDA CMOSN l=180n w=270n
M5 N003 N001 GNDA GNDA CMOSN l=180n w=270n
M6 N003 N001 VDDA VDDA CMOSP l=180n w=1u
M7 OUT N003 IN_B VDDA CMOSP l=180n w=1u
M8 OUT N001 IN_B GNDA CMOSN l=180n w=270n
M9 N001 Sel GNDA GNDA CMOSN l=180n w=270n
M10 N001 Sel VDDA VDDA CMOSP l=180n w=1u
.include tsmc018.lib
.ends analog_mux

.model NPN NPN
.model PNP PNP
.lib C:\Users\subha\OneDrive\Documents\LTspiceXVII\lib\cmp\standard.bjt
.model NMOS NMOS
.model PMOS PMOS
.lib C:\Users\subha\OneDrive\Documents\LTspiceXVII\lib\cmp\standard.mos
.tran 2m
.include tsmc018.lib
.param td 1n
.param trf 1n
* Putting 1nH ESL in capacitor makes the loop unstable.
* Ramp Generator cum Oscillator
* Error Amplifier
* Comparator
* Bandgap Reference @ 0.5V
* 1.5V
* 0.8V
* 1.2V
* Soft Start Circuit
* At 1.5V and 1A output current it automatically gets into PSM mode.
.backanno
.end
