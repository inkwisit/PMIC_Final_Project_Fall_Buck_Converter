* C:\Users\subha\OneDrive\Documents\GitHub\PMIC_Final_Project_Fall_Buck_Converter\Buck_Regulator_Schematic.asc
V1 vdd 0 PULSE(0 1.8 0 1n)
L1 N006 N007 0.47µ Rser=32m
M1 N006 N004 vdd vdd CMOSP l=180n w=100u m=500
M2 N006 N009 0 0 CMOSN l=180n w=100u m=200
I1 N007 0 PULSE(0 1 30u 100n 100n 50u 100u)
A1 0 0 N001 N002 0 N003 0 0 AND Vhigh=1.8,Vlow=0
A2 0 0 N008 N010 0 0 N005 0 AND Vhigh=1.8,Vlow=0
A3 N001 0 0 0 0 N010 0 0 BUF Vhigh=1.8,Vlow=0
A4 N005 0 0 0 0 N002 0 0 BUF Vhigh=1.8,Vlow=0,Td=10n
A5 N003 0 0 0 0 0 N008 0 BUF Vhigh=1.8,Vlow=0,Td=10n
A6 N003 0 0 0 0 0 N004 0 BUF Vhigh=1.8, Vlow=0, Trise = {trf}, Tfall = {trf}
A7 N005 0 0 0 0 0 N009 0 BUF Vhigh=1.8, Vlow=0, Trise = {trf}, Tfall = {trf}
R1 N007 N013 50k
R2 N013 0 100k
C3 N007 0 10µ Rser=10m Lser=1n
C4 N007 0 10µ Rser=10m Lser=1n
XX1 vdd N014 N011 0 N001 comparator
XX2 vdd N013 vref 0 N011 error_amplifier
XX3 0 vdd vref N014 oscillator
XX4 vdd 0 vref bandgap_reference
C6 N007 N013 30.65p
R3 N012 N011 500k
C5 N013 N012 12.65p

* block symbol definitions
.subckt comparator VDDA VINN VINP GNDA VOUT
M1 outp1 N002 VDDA VDDA CMOSP l=180n w=1.35u
M2 outn1 N002 VDDA VDDA CMOSP l=180n w=1.35u
M3 outp1 vinp N007 N007 CMOSN l=180n w=270n
M4 outn1 vinn N007 N007 CMOSN l=180n w=270n
M5 N007 N011 GNDA GNDA CMOSN l=720n w=2u
R1 N002 outn1 100k
R2 outp1 N002 100k
M6 pmos_gate N003 VDDA VDDA CMOSP l=180n w=1.35u
M7 N003 N003 VDDA VDDA CMOSP l=180n w=1.35u
M8 pmos_gate outn1 N008 N008 CMOSN l=180n w=270n
M9 N003 outp1 N008 N008 CMOSN l=180n w=270n
M10 N008 N011 GNDA GNDA CMOSN l=720n w=2u
M11 VOUT pmos_gate VDDA VDDA CMOSP l=180n w=700n
M12 VOUT nmos_gate GNDA GNDA CMOSN l=180n w=270n
M19 N011 N001 VDDA VDDA CMOSP l=720n w=10u
Q1 N010 N012 GNDA 0 2N3904
R3 N012 GNDA 1Meg
Q2 N001 N010 N012 0 2N3904
M20 N001 N001 VDDA VDDA CMOSP l=360n w=2.5u
R4 VDDA N010 1Meg
M21 N004 N001 VDDA VDDA CMOSP l=720n w=10u
M22 outn2 vinn N004 N004 CMOSP l=180n w=1.35u
M23 outp2 vinp N004 N004 CMOSP l=180n w=1.35u
M24 outn2 N006 GNDA GNDA CMOSN l=180n w=270n
M25 outp2 N006 GNDA GNDA CMOSN l=180n w=270n
R5 N006 outp2 100k
R6 outn2 N006 100k
M13 N005 N001 VDDA VDDA CMOSP l=720n w=10u
M14 nmos_gate outn2 N005 N005 CMOSP l=180n w=1.35u
M15 N009 outp2 N005 N005 CMOSP l=180n w=1.35u
M16 nmos_gate N009 GNDA GNDA CMOSN l=180n w=270n
M17 N009 N009 GNDA GNDA CMOSN l=180n w=270n
M18 N011 N011 GNDA GNDA CMOSN l=720n w=2u
.include tsmc018.lib
.ends comparator

.subckt error_amplifier VDDA VINN VINP GNDA VOUT
Q1 N005 N008 GNDA 0 2N3904
R1 N008 GNDA 100k
Q2 N001 N005 N008 0 2N3904
M1 N001 N001 VDDA VDDA CMOSP l=180n w=5u
R2 VDDA N005 100k
M11 N006 N001 VDDA VDDA CMOSP l=180n w=5u
M12 N006 N006 GNDA GNDA CMOSN l=180n w=1u
M2 N007 N006 GNDA GNDA CMOSN l=180n w=3u
M3 N002 N002 VDDA VDDA CMOSP l=360n w=2u
M4 N003 N002 VDDA VDDA CMOSP l=360n w=2u
M5 N002 VINN N007 GNDA CMOSN l=180n w=1u
M6 N003 VINP N007 GNDA CMOSN l=180n w=1u
M7 VOUT N003 VDDA VDDA CMOSP l=180n w=10u
M8 VOUT N006 GNDA GNDA CMOSN l=180n w=3u
C1 VOUT N004 8f
R3 N004 N003 19.569k
.include tsmc018.lib
.ends error_amplifier

.subckt oscillator GNDA VDDA vref VOUT
M1 N004 N003 vdda vdda CMOSP l=360n w=2.5u
M2 N003 N003 vdda vdda CMOSP l=360n w=2.5u
M3 N004 vref N008 N008 CMOSN l=360n w=500n
M4 N003 N009 N008 N008 CMOSN l=360n w=500n
M5 N008 vbn0 GNDA GNDA CMOSN l=720n w=2u
M7 vbn0 vbp0 vdda vdda CMOSP l=360n w=2.5u
Q1 N013 N015 GNDA 0 2N3904
R1 N015 GNDA 1Meg
Q2 vbp0 N013 N015 0 2N3904
M8 vbp0 vbp0 vdda vdda CMOSP l=360n w=2.5u
R2 vdda N013 1Meg
M9 1v3 N004 vdda vdda CMOSP l=180n w=1u
M10 VOUT N005 vdda vdda CMOSP l=180n w=1.1u
C1 VOUT GNDA 0.115p
R3 1v3 N009 500k
M11 VOUT N014 GNDA GNDA CMOSN l=180n w=2.2u
M12 Q_b S GNDA GNDA CMOSN l=180n w=270n
M13 Q_b Q GNDA GNDA CMOSN l=180n w=270n
M14 N006 S vdda vdda CMOSP l=180n w=1u
M15 Q_b Q N006 N006 CMOSP l=180n w=1u
M16 Q R GNDA GNDA CMOSN l=180n w=270n
M17 Q Q_b GNDA GNDA CMOSN l=180n w=270n
M18 N007 R vdda vdda CMOSP l=180n w=270n
M19 Q Q_b N007 N007 CMOSP l=180n w=270n
M20 S N001 vdda vdda CMOSP l=180n w=5u
M21 N001 N001 vdda vdda CMOSP l=180n w=5u
M22 S 1v3 N011 N011 CMOSN l=180n w=1u
M23 N001 VOUT N011 N011 CMOSN l=180n w=1u
M24 N011 vbn0 GNDA GNDA CMOSN l=720n w=2u
M25 R N002 vdda vdda CMOSP l=180n w=1u
M26 N002 N002 vdda vdda CMOSP l=180n w=1u
M27 R VOUT N012 N012 CMOSN l=180n w=270n
M28 N002 0v5 N012 N012 CMOSN l=180n w=270n
M29 N012 vbn0 GNDA GNDA CMOSN l=720n w=2u
M30 N010 N005 vdda vdda CMOSP l=180n w=11u
R5 N010 N014 100k
M31 N010 N010 GNDA GNDA CMOSN l=180n w=1u
M32 N014 Q_b GNDA GNDA CMOSN l=180n w=270n
R6 N005 N004 100k
M33 vbn0 vbn0 GNDA GNDA CMOSN l=720n w=2u
R4 0v5 GNDA 500k
R7 N009 0v5 300k
.include tsmc018.lib
.ends oscillator

.subckt bandgap_reference VDDA GNDA Vref
M1 N006 N001 VDDA VDDA CMOSP l=360n w=2.5u
M2 N004 N001 VDDA VDDA CMOSP l=360n w=2.5u
M3 Vref N001 VDDA VDDA CMOSP l=360n w=2.5u
R1 Vref GNDA 90k
R2 N006 N009 10k
R3 N006 GNDA 124.608k
Q1 GNDA GNDA N004 0 2N3906
R4 N004 GNDA 124.608k
M4 N001 N003 VDDA VDDA CMOSP l=360n w=2.5u
M5 N003 N003 VDDA VDDA CMOSP l=360n w=2.5u
Q2 GNDA GNDA N009 0 2N3906
Q3 GNDA GNDA N009 0 2N3906
Q4 GNDA GNDA N009 0 2N3906
Q5 GNDA GNDA N009 0 2N3906
Q6 GNDA GNDA N009 0 2N3906
Q7 GNDA GNDA N009 0 2N3906
Q8 GNDA GNDA N009 0 2N3906
Q9 GNDA GNDA N009 0 2N3906
M6 N001 N004 N005 N005 CMOSN l=360n w=500n
M7 N003 N006 N005 N005 CMOSN l=360n w=500n
M8 N005 N008 GNDA GNDA CMOSN l=720n w=2u
M9 N008 N008 GNDA GNDA CMOSP l=720n w=2u
M10 N008 N002 VDDA VDDA CMOSP l=360n w=2.5u
Q10 N007 N010 GNDA 0 2N3904
R5 N010 GNDA 1Meg
Q11 N002 N007 N010 0 2N3904
M11 N002 N002 VDDA VDDA CMOSP l=360n w=2.5u
R6 VDDA N007 1Meg
C1 VDDA N004 1p
.include tsmc018.lib
.ends bandgap_reference

.model NPN NPN
.model PNP PNP
.lib C:\Users\subha\OneDrive\Documents\LTspiceXVII\lib\cmp\standard.bjt
.model NMOS NMOS
.model PMOS PMOS
.lib C:\Users\subha\OneDrive\Documents\LTspiceXVII\lib\cmp\standard.mos
.tran 160u
.include tsmc018.lib
.param td 1n
.param trf 1n
* Putting 1nH ESL in capacitor makes the loop unstable.
* Ramp Generator cum Oscillator
* Error Amplifier
* Comparator
* Bandgap Reference @ 0.8V
.backanno
.end
