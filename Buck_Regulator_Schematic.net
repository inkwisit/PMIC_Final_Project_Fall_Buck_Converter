* C:\Users\subha\OneDrive\Documents\GitHub\PMIC_Final_Project_Fall_Buck_Converter\Buck_Regulator_Schematic.asc
V1 vdd 0 PULSE(0 1.8 0 1n)
L1 N006 N007 0.47µ Rser=32m
C1 N007 0 10µ Rser=10m Lser=1n
M1 N006 N004 vdd vdd CMOSP l=180n w=100u m=500
M2 N006 N009 0 0 CMOSN l=180n w=100u m=200
I1 N007 0 PULSE(0 100m 200u)
A1 0 0 N001 N002 0 N003 0 0 AND Vhigh=1.8,Vlow=0
A2 0 0 N008 N010 0 0 N005 0 AND Vhigh=1.8,Vlow=0
A3 N001 0 0 0 0 N010 0 0 BUF Vhigh=1.8,Vlow=0
A4 N005 0 0 0 0 N002 0 0 BUF Vhigh=1.8,Vlow=0,Td=10n
A5 N003 0 0 0 0 0 N008 0 BUF Vhigh=1.8,Vlow=0,Td=10n
A6 N003 0 0 0 0 0 N004 0 BUF Vhigh=1.8, Vlow=0, Trise = {trf}, Tfall = {trf}
A7 N005 0 0 0 0 0 N009 0 BUF Vhigh=1.8, Vlow=0, Trise = {trf}, Tfall = {trf}
V2 N014 0 PULSE(0 0.8 0 1u)
V3 N012 0 PULSE(0 1.8 0 112.5n 12.5n 0u 125n)
R1 N007 N011 10k
R2 N011 0 10k
C2 N007 0 10µ Rser=10m Lser=1n
C3 N007 0 10µ Rser=10m Lser=1n
C4 N007 0 10µ Rser=10m Lser=1n
XX1 vdd N012 N013 0 N001 comparator
XX2 vdd N011 N014 0 N013 error_amplifier

* block symbol definitions
.subckt comparator VDDA VINN VINP GNDA VOUT
M1 outp1 N002 VDDA VDDA CMOSP l=180n w=1.35u
M2 outn1 N002 VDDA VDDA CMOSP l=180n w=1.35u
M3 outp1 vinp N007 N007 CMOSN l=180n w=270n
M4 outn1 vinn N007 N007 CMOSN l=180n w=270n
M5 N007 N011 GNDA GNDA CMOSN l=720n w=2u
R1 N002 outn1 100k
R2 outp1 N002 100k
M6 pmos_gate N003 VDDA VDDA CMOSP l=180n w=1.35u
M7 N003 N003 VDDA VDDA CMOSP l=180n w=1.35u
M8 pmos_gate outn1 N008 N008 CMOSN l=180n w=270n
M9 N003 outp1 N008 N008 CMOSN l=180n w=270n
M10 N008 N011 GNDA GNDA CMOSN l=720n w=2u
M11 VOUT pmos_gate VDDA VDDA CMOSP l=180n w=700n
M12 VOUT nmos_gate GNDA GNDA CMOSN l=180n w=270n
M19 N011 N001 VDDA VDDA CMOSP l=720n w=10u
Q1 N010 N012 GNDA 0 2N3904
R3 N012 GNDA 1Meg
Q2 N001 N010 N012 0 2N3904
M20 N001 N001 VDDA VDDA CMOSP l=360n w=2.5u
R4 VDDA N010 1Meg
M21 N004 N001 VDDA VDDA CMOSP l=720n w=10u
M22 outn2 vinn N004 N004 CMOSP l=180n w=1.35u
M23 outp2 vinp N004 N004 CMOSP l=180n w=1.35u
M24 outn2 N006 GNDA GNDA CMOSN l=180n w=270n
M25 outp2 N006 GNDA GNDA CMOSN l=180n w=270n
R5 N006 outp2 100k
R6 outn2 N006 100k
M13 N005 N001 VDDA VDDA CMOSP l=720n w=10u
M14 nmos_gate outn2 N005 N005 CMOSP l=180n w=1.35u
M15 N009 outp2 N005 N005 CMOSP l=180n w=1.35u
M16 nmos_gate N009 GNDA GNDA CMOSN l=180n w=270n
M17 N009 N009 GNDA GNDA CMOSN l=180n w=270n
M18 N011 N011 GNDA GNDA CMOSN l=720n w=2u
.include tsmc018.lib
.ends comparator

.subckt error_amplifier VDDA VINN VINP GNDA VOUT
Q1 N005 N008 GNDA 0 2N3904
R1 N008 GNDA 150k
Q2 N001 N005 N008 0 2N3904
M1 N001 N001 VDDA VDDA CMOSP l=180n w=5u
R2 VDDA N005 150k
M11 N006 N001 VDDA VDDA CMOSP l=180n w=5u
M12 N006 N006 GNDA GNDA CMOSN l=180n w=1u
M2 N007 N006 GNDA GNDA CMOSN l=180n w=2u
M3 N002 N002 VDDA VDDA CMOSP l=360n w=2u
M4 N003 N002 VDDA VDDA CMOSP l=360n w=2u
M5 N002 VINN N007 GNDA CMOSN l=180n w=1u
M6 N003 VINP N007 GNDA CMOSN l=180n w=1u
M7 VOUT N003 VDDA VDDA CMOSP l=180n w=10u
M8 VOUT N006 GNDA GNDA CMOSN l=180n w=2u
C1 VOUT N004 8f
R3 N004 N003 19.569k
.include tsmc018.lib
.ends error_amplifier

.model NPN NPN
.model PNP PNP
.lib C:\Users\subha\OneDrive\Documents\LTspiceXVII\lib\cmp\standard.bjt
.model NMOS NMOS
.model PMOS PMOS
.lib C:\Users\subha\OneDrive\Documents\LTspiceXVII\lib\cmp\standard.mos
.tran 10m
.include tsmc018.lib
.param td 1n
.param trf 1n
* Putting 1nH ESL in capacitor makes the loop unstable.
.include opamp.sub
.backanno
.end
